<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Prosty link (globalny)</title>
  <link rel="icon" href="data:,">
  <style>
    :root { --bg:#0f1220; --fg:#e9ecf1; --accent:#4bd1a0; --muted:#97a1ae; --btn:#22283a; --btn-hover:#2d3550; }
    *{box-sizing:border-box} html,body{height:100%;margin:0}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial;background:radial-gradient(1200px 800px at 50% 30%, #1a1f35 0%, #0d1020 60%, #0a0d1a 100%);color:var(--fg)}
    .main{min-height:100%;display:flex;align-items:center;justify-content:center;padding:24px;text-align:center}
    a#mainLink{font-size:clamp(20px,5vw,42px);color:var(--accent);text-decoration:none;border-bottom:2px solid transparent;transition:.2s}
    a#mainLink:hover,a#mainLink:focus{border-bottom-color:var(--accent)}
    .topbar{position:fixed;top:10px;right:10px;display:flex;gap:8px}
    button{background:var(--btn);color:var(--fg);border:1px solid #3a4568;padding:8px 12px;border-radius:10px;cursor:pointer;transition:.15s;font-weight:600}
    button:hover{background:var(--btn-hover)}
    .small{position:fixed;bottom:10px;width:100%;text-align:center;color:var(--muted);font-size:.85rem}
  </style>
</head>
<body>
  <div class="topbar">
    <button id="editBtn" title="Zmień dla wszystkich (commit na GitHubie)">Edytuj (globalnie)</button>
    <button id="refreshBtn" title="Wczytaj ponownie konfigurację">Odśwież</button>
  </div>

  <main class="main">
    <a id="mainLink" href="#" target="_blank" rel="noopener">Ładowanie…</a>
  </main>

  <div class="small">Ten link jest sterowany plikiem data.json w repo. Zmiana = commit → widzą wszyscy.</div>

  <script>
    // Dostosuj te 2 wartości, jeśli zmienisz nazwę użytkownika/repo/gałęzi:
    const OWNER = 'majstersztyk24';
    const REPO  = 'kpss';
    const BRANCH = 'main';

    const link = document.getElementById('mainLink');
    const refreshBtn = document.getElementById('refreshBtn');
    const editBtn = document.getElementById('editBtn');

    async function loadConfig(alertOnError) {
      try {
        const res = await fetch('data.json?v=' + Date.now(), { cache: 'no-store' });
        if (!res.ok) throw new Error('HTTP ' + res.status);
        const cfg = await res.json();
        const text = (cfg.text || 'Kliknij tutaj').toString();
        let url = (cfg.url || 'https://example.com').toString().trim();
        if (url && !/^https?:\/\//i.test(url)) url = 'https://' + url;
        link.textContent = text;
        link.href = url;
      } catch (e) {
        if (alertOnError) alert('Nie udało się wczytać data.json. Upewnij się, że plik istnieje w repo.');
        link.textContent = 'Kliknij tutaj';
        link.href = 'https://example.com';
      }
    }

    editBtn.addEventListener('click', () => {
      const editUrl = `https://github.com/${OWNER}/${REPO}/edit/${BRANCH}/data.json`;
      window.open(editUrl, '_blank');
    });
    refreshBtn.addEventListener('click', () => loadConfig(true));

    loadConfig(false);
  </script>
</body>
</html>
